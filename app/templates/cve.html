{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}{{ vex.cve }}{% endblock %}</h1>
{% endblock %}

{% block content %}
<p>Public on {{ vex.release_date }}<br />
Updated: {{ vex.updated }}</p>

<p>{% if vex.global_impact %}{{ vex.global_impact }}{% else %}No{% endif %} Impact</p>
<p><a href="https://access.redhat.com/security/updates/classification/">What does this mean?</a></p>

<p>{% if vex.global_cvss %}<b>{{ vex.global_cvss['baseScore'] }}</b>{% else %}N/A{% endif %} | <a href="#cvss-breakdown">CVSS v3 Score Breakdown</a></p>

<table class="table">
  <tr style="vertical-align:top">
    <td>
      <h2>Description</h2>
      <p>{{ vex.notes['description']['Vulnerability description'] }}</p>

      <h2>Additional Information</h2>
      <ul>
{% if vex.bz_id %}<li> <a href="https://bugzilla.redhat.com/show_bug.cgi?id={{ vex.bz_id }}">Bugzilla {{ vex.bz_id }}</a>: {{ vex.summary }}</li>{% endif %}
  {%if vex.cwe_id %}<li> <a href="http://cwe.mitre.org/data/definitions/{{ vex.cwe }}.html">{{ vex.cwe_id }}</a>: {{ vex.cwe_name }}</li>{% endif %}
  <li> <a href="#cve-faq">FAQ:</a> Frequently asked questions about {{ vex.cve }}</li>
      </ul>
    </td>
    <td>
    <h3>External References</h3>
      <ul>
        {% for url in vex.references %}<li><a href="{{ url }}">{{ url }}</a></li>{% endfor %}
      </ul>
    </td>
  </tr>
</table>

{% if vex.statement %}
<h2>Statement</h2>
<p>{{ vex.statement }}</p>
{% endif %}

{% if packages.mitigation %}
<h2>Mitigations</h2>

{% for x in packages.mitigation %}<p>{{ x }}</p>{% endfor %}
{% endif %}

<h2>Affected Packages and Issued Red Hat Security Errata</h2>
<table class="table table-striped table-bordered">
  <thead>
  <tr><th>Product / Service</th><th>Components</th><th>Errata</th><th>Release Date</th></tr>
  </thead>
  <tbody>
{% for x in packages.fixes %}
  <tr><td>{{ x.product }}</td><td>{{ ', '.join(x.components) }}</td><td><a href="https://access.redhat.com/errata/{{ x.id }}">{{ x.id }}</a></td><td>NOT YET</td></tr>
{% endfor %}
  </tbody>
</table>

{% if packages.not_affected %}
<h2>Unaffected Packages</h2>
<table class="table table-striped table-bordered">
  <thead>
  <tr><th>Product / Service</th><th>Components</th></tr>
  </thead>
  <tbody>
{% for x in packages.not_affected %}
  <tr><td>{{ x.product }}</td><td>{{ ', '.join(x.components) }}</td></tr>
{% endfor %}
  </tbody>
</table>
{% endif %}

{% if packages.wontfix %}
<h2>Affected packages without fixes</h2>
<table class="table table-striped table-bordered">
  <thead>
  <tr><th>Product / Service</th><th>Components</th><th>Reason</th></tr>
  </thead>
  <tbody>
{% for x in packages.wontfix %}
  <tr><td>{{ x.product }}</td><td>{{ x.component }}</td><td>{% if x.reason == 'Out of support scope' %}<a href="https://access.redhat.com/support/policy/updates/errata/">{{ x.reason }}</a>{% else %}{{ x.reason }}{% endif %}</td></tr>
{% endfor %}
  </tbody>
</table>
{% endif %}

<h2 id="cve-faq"></h2>
<p>Some FAQ stuffs</p>

{% endblock %}